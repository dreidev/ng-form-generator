angular.module("app",["formBuild"]),angular.module("app").controller("SimpleDemoController",["$compile","$scope","$sce","builder",function(a,b,c,d){}]),angular.module("formBuild",["dndLists","ui.bootstrap"]),angular.module("formBuild").directive("ngFormBuilder",["$compile","$rootScope","builder",function(a,b,c){return{restrict:"E",replace:!0,scope:{output:"="},templateUrl:"htmlTemplates/formBuilder.html",controller:["$scope",function(a){a.emptyObject={required:!1,title:"title here",description:"description here",options:["option 1","option 2"]},a.dragVars={dragging:!1,beforeDrag:[],afterDrag:[]},a.startDrag=function(){a.dragVars.dragging=!0,a.dragVars.before=a.model.builder},a.endDrag=function(){a.dragVars.dragging=!1,a.dragVars.after=a.model.builder},a.addCustomFields=function(){a.choices=a.choices.concat(c.choices),a.extraChoices=c.choices},a.model={builder:[]},a.dynamicPopover={textInput:"popover/textInput.html",radioInput:"popover/radioInput.html"},a.choices=[{type:"input",display:'<div class="form-group"><label for="" class="col-sm-4 control-label ng-binding" >Text Input</label><div class="col-sm-8"><input type="text" disabled="disabled" ng-model="inputText" validator-required="false" validator-group="" id="" class="form-control ng-pristine ng-valid" placeholder="placeholder"><p class="help-block ng-binding">description</p></div></div>',htmlTemplate:"htmlTemplates/text-input.html",popoverTemplateUrl:"popover/textInput.html"},{type:"radio",display:'<div class="form-group"> <label for="" class="col-sm-4 control-label">Radio</label> <div class="col-sm-8"> <div class="radio"> <label class=""><input name="" validator-group="" value="value one" type="radio" class=""> value one </label> </div> <div class="radio"> <label class=""><input name="" validator-group="" value="value two" type="radio" class=""> value two </label> </div> <p class="help-block">description</p> </div> </div>',htmlTemplate:"htmlTemplates/radio-input.html",popoverTemplateUrl:"popover/radioInput.html"},{type:"password",display:'<div class=""><div class="form-group"><label for="" class="col-sm-4 control-label">Password<span ng-show="object.required">*</span></label><div class="col-sm-8"><input type="password" class="form-control" ng-model="object.models" placeholder="placeholder" required="object.required"><p class="help-block">Description</p></div></div></div>',htmlTemplate:"htmlTemplates/password.html",popoverTemplateUrl:"popover/password.html"},{type:"date",display:'<div class=""><div class="form-group"><label for="" class="col-sm-4 control-label">Date<span ng-show="object.required">*</span></label><div class="col-sm-8"><input type="date" class="form-control" ng-model="object.models" placeholder="placeholder" required="object.required"><p class="help-block">Description</p></div></div></div>',htmlTemplate:"htmlTemplates/date.html",popoverTemplateUrl:"popover/date.html"},{type:"dropdown",display:'<div class="">                    <div class="form-group">                        <label for="" class="col-sm-4 control-label">Dropdown                           <span ng-show="object.required">*</span>                        </label>                        <div class="col-sm-8">                            <select><option value="option">option</option>                            </select>                        </div>                    </div></div>',htmlTemplate:"htmlTemplates/dropdown.html",popoverTemplateUrl:"popover/dropdown.html"},{type:"checkbox",display:'<div class=""><div class="form-group"><label for="" class="col-sm-4 control-label">Checkbox<span ng-show="object.required">*</span></label><div class="col-sm-8"><div class="radio"><label><input type="checkbox"  name="group"/>option 1</label><br /><label><input type="checkbox"  name="group"/>option 2</label></div><p class="help-block">{{object.description}}</p></div><br clear="all"/></div>',htmlTemplate:"htmlTemplates/checkbox.html",popoverTemplateUrl:"popover/checkbox.html"},{type:"checkbox",display:'<div class=""><div class="form-group"><label for="" class="col-sm-4 control-label">Checkbox<span ng-show="object.required">*</span></label><div class="col-sm-8"><div class="radio"><label><input type="checkbox"  name="group"/>option 1</label><br /><label><input type="checkbox"  name="group"/>option 2</label></div><p class="help-block">{{object.description}}</p></div><br clear="all"/></div>',htmlTemplate:"htmlTemplates/checkbox.html",popoverTemplateUrl:"popover/delete.html"}],a["delete"]=function(b){a.model.builder.splice(b,1)},a.dragoverCallback=function(b,c,d,e){return a.startDrag(),!0},a.dropCallback=function(b,c,d,e,f,g){if(e){if("itemType"===g&&!d.label)return!1;if("containerType"===g&&!angular.isArray(d))return!1}return a.endDrag(),d},a.addCustomFields(),a.$watch("model.builder",function(c,d){var e=0;if(!a.dragVars.dragging){for(e=0;e<a.model.builder.length;e++){var f=JSON.parse(JSON.stringify(a.emptyObject));f.id=e,"required"in a.model.builder[e]||angular.extend(a.model.builder[e],f)}var g=JSON.parse(JSON.stringify(a.model.builder));a.output=g,b.builder=a.model.builder,b.$broadcast("formBuilder:input changed")}},!0)}],link:function(a,b,c,d){}}}]),angular.module("formBuild").directive("ngFormReader",["$templateRequest","$compile","$rootScope","builder",function(a,b,c,d){return{restrict:"E",replace:!0,scope:{input:"=",data:"="},templateUrl:"htmlTemplates/formReader.html",controller:["$scope",function(a){a.submit=function(){for(var b=[],c=0;c<a.input.length;c++){var d=JSON.parse(JSON.stringify(a.input[c]));delete d.type,delete d.popoverTemplateUrl,delete d.display,delete d.htmlTemplate,b[c]=d}a.data=b,console.log(b)}}],link:function(a,b,c,d){}}}]),angular.module("formBuild").factory("builder",function(){return{choices:[],insert:function(a){this.choices.push(a)}}}),angular.module("formBuild").directive("radioInput",function(){return{restrict:"EA",scope:{object:"=",popoverTemplateUrl:"@?"},templateUrl:"./htmlTemplates/radio-input.html",link:function(a,b,c){}}}),angular.module("formBuild").directive("textInput",function(){return{restrict:"EA",scope:{object:"=",popoverTemplateUrl:"@?"},templateUrl:"./htmlTemplates/text-input.html",link:function(a,b,c){}}}),angular.module("formBuild").directive("ngRender",["$compile","builder","$rootScope",function(a,b,c){return{restrict:"A",scope:{ngRender:"="},link:function(b,d,e,f){b.title="default",b.model={builder:[]},b.model.builder=c.builder,b.init=function(){var c=a(b.ngRender.display)(b);d.append(c)},b.$watch("title",function(a,c){b.init()},!0)}}}]),angular.module("formBuild").directive("ngHtml",["$compile",function(a){return function(b,c,d){d.ngHtml&&(c.html(b.$eval(d.ngHtml)),a(c.contents())(b)),b.$watch(d.ngHtml,function(d,e){d&&d!==e&&(c.html(d),a(c.contents())(b))})}}]),angular.module("formBuild").directive("abstract",function(){return{restrict:"EA",scope:{object:"=",popoverTemplateUrl:"@?",choice:"=?",template:"="},link:function(a,b,c){a.getContentUrl=function(){return a.template}},template:'<div ng-include="getContentUrl()"></div>'}}),angular.module("formBuild").directive("delete",function(){return{restrict:"E",replace:!0,scope:!1,templateUrl:"htmlTemplates/delete.html",controller:["$scope",function(a){}]}}),angular.module("dndLists",[]).directive("dndDraggable",["$parse","$timeout","dndDropEffectWorkaround","dndDragTypeWorkaround",function(a,b,c,d){return function(e,f,g){f.attr("draggable","true"),g.dndDisableIf&&e.$watch(g.dndDisableIf,function(a){f.attr("draggable",!a)}),f.on("dragstart",function(h){return h=h.originalEvent||h,"false"==f.attr("draggable")?!0:(h.dataTransfer.setData("Text",angular.toJson(e.$eval(g.dndDraggable))),h.dataTransfer.effectAllowed=g.dndEffectAllowed||"move",f.addClass("dndDragging"),b(function(){f.addClass("dndDraggingSource")},0),c.dropEffect="none",d.isDragging=!0,d.dragType=g.dndType?e.$eval(g.dndType):void 0,h._dndHandle&&h.dataTransfer.setDragImage&&h.dataTransfer.setDragImage(f[0],0,0),a(g.dndDragstart)(e,{event:h}),void h.stopPropagation())}),f.on("dragend",function(h){h=h.originalEvent||h;var i=c.dropEffect;e.$apply(function(){switch(i){case"move":a(g.dndMoved)(e,{event:h});break;case"copy":a(g.dndCopied)(e,{event:h});break;case"none":a(g.dndCanceled)(e,{event:h})}a(g.dndDragend)(e,{event:h,dropEffect:i})}),f.removeClass("dndDragging"),b(function(){f.removeClass("dndDraggingSource")},0),d.isDragging=!1,h.stopPropagation()}),f.on("click",function(b){g.dndSelected&&(b=b.originalEvent||b,e.$apply(function(){a(g.dndSelected)(e,{event:b})}),b.stopPropagation())}),f.on("selectstart",function(){this.dragDrop&&this.dragDrop()})}}]).directive("dndList",["$parse","$timeout","dndDropEffectWorkaround","dndDragTypeWorkaround",function(a,b,c,d){return function(e,f,g){function h(a,b,c){var d=r?a.offsetX||a.layerX:a.offsetY||a.layerY,e=r?b.offsetWidth:b.offsetHeight,f=r?b.offsetLeft:b.offsetTop;return f=c?f:0,f+e/2>d}function i(){var a;return angular.forEach(f.children(),function(b){var c=angular.element(b);c.hasClass("dndPlaceholder")&&(a=c)}),a||angular.element("<li class='dndPlaceholder'></li>")}function j(){return Array.prototype.indexOf.call(q.children,p)}function k(a){if(!d.isDragging&&!s)return!1;if(!n(a.dataTransfer.types))return!1;if(g.dndAllowedTypes&&d.isDragging){var b=e.$eval(g.dndAllowedTypes);if(angular.isArray(b)&&-1===b.indexOf(d.dragType))return!1}return g.dndDisableIf&&e.$eval(g.dndDisableIf)?!1:!0}function l(){return o.remove(),f.removeClass("dndDragover"),!0}function m(b,c,f,g){return a(b)(e,{event:c,index:f,item:g||void 0,external:!d.isDragging,type:d.isDragging?d.dragType:void 0})}function n(a){if(!a)return!0;for(var b=0;b<a.length;b++)if("Text"===a[b]||"text/plain"===a[b])return!0;return!1}var o=i(),p=o[0],q=f[0];o.remove();var r=g.dndHorizontalList&&e.$eval(g.dndHorizontalList),s=g.dndExternalSources&&e.$eval(g.dndExternalSources);f.on("dragenter",function(a){return a=a.originalEvent||a,k(a)?void a.preventDefault():!0}),f.on("dragover",function(a){if(a=a.originalEvent||a,!k(a))return!0;if(p.parentNode!=q&&f.append(o),a.target!==q){for(var b=a.target;b.parentNode!==q&&b.parentNode;)b=b.parentNode;b.parentNode===q&&b!==p&&(h(a,b)?q.insertBefore(p,b):q.insertBefore(p,b.nextSibling))}else if(h(a,p,!0))for(;p.previousElementSibling&&(h(a,p.previousElementSibling,!0)||0===p.previousElementSibling.offsetHeight);)q.insertBefore(p,p.previousElementSibling);else for(;p.nextElementSibling&&!h(a,p.nextElementSibling,!0);)q.insertBefore(p,p.nextElementSibling.nextElementSibling);return g.dndDragover&&!m(g.dndDragover,a,j())?l():(f.addClass("dndDragover"),a.preventDefault(),a.stopPropagation(),!1)}),f.on("drop",function(a){if(a=a.originalEvent||a,!k(a))return!0;a.preventDefault();var b,d=a.dataTransfer.getData("Text")||a.dataTransfer.getData("text/plain");try{b=JSON.parse(d)}catch(f){return l()}var h=j();return g.dndDrop&&(b=m(g.dndDrop,a,h,b),!b)?l():(b!==!0&&e.$apply(function(){e.$eval(g.dndList).splice(h,0,b)}),m(g.dndInserted,a,h,b),"none"===a.dataTransfer.dropEffect?"copy"===a.dataTransfer.effectAllowed||"move"===a.dataTransfer.effectAllowed?c.dropEffect=a.dataTransfer.effectAllowed:c.dropEffect=a.ctrlKey?"copy":"move":c.dropEffect=a.dataTransfer.dropEffect,l(),a.stopPropagation(),!1)}),f.on("dragleave",function(a){a=a.originalEvent||a,f.removeClass("dndDragover"),b(function(){f.hasClass("dndDragover")||o.remove()},100)})}}]).directive("dndNodrag",function(){return function(a,b,c){b.attr("draggable","true"),b.on("dragstart",function(a){a=a.originalEvent||a,a._dndHandle||(a.dataTransfer.types&&a.dataTransfer.types.length||a.preventDefault(),a.stopPropagation())}),b.on("dragend",function(a){a=a.originalEvent||a,a._dndHandle||a.stopPropagation()})}}).directive("dndHandle",function(){return function(a,b,c){b.attr("draggable","true"),b.on("dragstart dragend",function(a){a=a.originalEvent||a,a._dndHandle=!0})}}).factory("dndDragTypeWorkaround",function(){return{}}).factory("dndDropEffectWorkaround",function(){return{}}),angular.module("formBuild").run(["$templateCache",function(a){"use strict";a.put("htmlTemplates/checkbox.html",'<div><div class=form-group><label for="" class="col-sm-4 control-label">{{object.title}} <span ng-show=object.required>*</span></label><div class=col-sm-8><div class=radio ng-repeat="option in object.options track by $index"><label><input type=checkbox ng-model=object[option] name="group"/> {{option}}</label></div><p class=help-block>{{object.description}}</p></div><br clear="all"/></div></div>'),a.put("htmlTemplates/date.html",'<div><div class=form-group><label for="" class="col-sm-4 control-label">{{object.title}} <span ng-show=object.required>*</span></label><div class=col-sm-8><input type=date class=form-control ng-model=object.models placeholder={{object.title}} required><p class=help-block>{{object.description}}</p></div></div></div>'),a.put("htmlTemplates/delete.html",'<button class="btn btn-danger" ng-click=delete($index) type=button name=button>DELETE</button>'),a.put("htmlTemplates/dropdown.html",'<div><div class=form-group><label for="" class="col-sm-4 control-label">{{object.title}} <span ng-show=object.required>*</span></label><div class=col-sm-8><select ng-required=object.required ng-model=object.value ng-options="option for option in object.options"></select></div></div></div>'),a.put("htmlTemplates/formBuilder.html",'<div><div class="flex simpleDemo"><ul dnd-dragover="dragoverCallback(event, index, external, type)" dnd-drop="dropCallback(event, index, item, external, type, \'containerType\')" dnd-list=model.builder class=builder><li ng-repeat="object in model.builder" dnd-draggable=object dnd-moved="model.builder.splice($index, 1)" dnd-effect-allowed=move dnd-selected="selected1 = object" ng-class="{\'selected\': selected1 === object}"><div class=myFormItem uib-popover-template=object.popoverTemplateUrl popover-title="Element {{$index}}" popover-placement=bottom-right><abstract class=myFormItem template=object.htmlTemplate object=object choice=object></abstract></div></li></ul><ul class=choices><li class="extra-height myFormItem" ng-repeat="item2 in choices" dnd-draggable=item2 dnd-effect-allowed=copy dnd-copied="item2.id = item2.id + 1"><div ng-html=item2.display></div></li></ul></div></div>'),a.put("htmlTemplates/formReader.html",'<div class="flex simpleDemo"><div id=form-parent><form id=form class=choices ng-submit=submit()><div ng-repeat="item in input"><abstract class=myFormItem template=item.htmlTemplate object=item choice=item></abstract></div><button class="btn btn-primary">Submit</button></form></div></div>'),a.put("htmlTemplates/password.html",'<div><div class=form-group><label for="" class="col-sm-4 control-label">{{object.title}} <span ng-show=object.required>*</span></label><div class=col-sm-8><input type=password class=form-control ng-model=object.models placeholder={{object.title}} required><p class=help-block>{{object.description}}</p></div></div></div>'),a.put("htmlTemplates/radio-input.html",'<div ng-if="object.type == \'radio\'"><div class=form-group><label for="" class="col-sm-4 control-label">{{object.title}} <span ng-show=object.required>*</span></label><div class=col-sm-8><div class=radio ng-repeat="option in object.options track by $index"><label><input type=radio name=option value={{option}} ng-model=object.value ng-required="$index == 0 && object.required"> {{option}}</label></div><p class=help-block>{{object.description}}</p></div><br clear="all"/></div></div>'),a.put("htmlTemplates/sample.html",'<div><div class=form-group><label for="" class="col-sm-4 control-label">{{object.title}} <span ng-show=object.required>*</span></label><div class=col-sm-8><input type=text class=form-control ng-model=object.value placeholder={{object.title}} required><p class=help-block>{{object.description}}</p></div></div></div>'),a.put("htmlTemplates/text-input.html",'<div ng-if="object.type == \'input\'"><div class=form-group><label for="" class="col-sm-4 control-label">{{object.title}} <span ng-show=object.required>*</span></label><div class=col-sm-8><input type=text ng-model=object.value class=form-control placeholder={{object.title}} required><p class=help-block>{{object.description}}</p></div></div></div>'),a.put("popover/checkbox.html",'<div class=form-group><label>Popup Title:</label><input type=text ng-model=object.title class="form-control"/><label>Required Field:</label><label class=checkbox-inline><input type=checkbox name=required ng-model=object.required> Required</label><textarea ng-model=object.options rows=5 ng-trim=false ng-list=&#10;>\n    </textarea><input type=text ng-model="object.description"/><delete/></div>'),a.put("popover/date.html",'<div class=form-group><label>Password:</label><input type=text ng-model=object.title class="form-control"/><label>Required Field:</label><input type=checkbox ng-model="object.required"/> <input type=text ng-model="object.description"/><delete/></div>'),a.put("popover/dropdown.html",'<div class=form-group><label>Popup Title:</label><input type=text ng-model=object.title class="form-control"/><label>Required Field:</label><label class=checkbox-inline><input type=checkbox name=required ng-model=object.required> Required</label><textarea ng-model=object.options rows=5 ng-trim=false ng-list=&#10;>\n    </textarea><input type=text ng-model="object.description"/><delete/></div>'),a.put("popover/password.html",'<div class=form-group><label>Password:</label><input type=text ng-model=object.title class="form-control"/><label>Required Field:</label><input type=checkbox ng-model="object.required"/> <input type=text ng-model="object.description"/><delete/></div>'),a.put("popover/radioInput.html",'<div class=form-group><label>Popup Title:</label><input type=text ng-model=object.title class="form-control"/><label>Required Field:</label><label class=checkbox-inline><input type=checkbox name=required ng-model=object.required> Required</label><textarea ng-model=object.options rows=5 ng-trim=false ng-list=&#10;>\n    </textarea><input type=text ng-model="object.description"/><delete/></div>'),a.put("popover/sample.html",'<div class=form-group><label>Popup Title:</label><input type=text ng-model=object.title class="form-control"/><label>Required Field:</label><input type=checkbox ng-model="object.required"/> <input type=text ng-model="object.description"/><delete/></div>'),a.put("popover/textInput.html",'<div class=form-group><label>Popup Title:</label><input type=text ng-model=object.title class="form-control"/><label>Required Field:</label><input type=checkbox ng-model="object.required"/> <input type=text ng-model="object.description"/><delete/></div>')}]);